title = "Platform Security Secret Rules"
version = "2.2.0"

[[rules]]
id = "aws-access-key"
description = "AWS Access Key"
regex = '''\b(A3T[A-Z0-9]{16}|AKIA[0-9A-Z]{16}|ASIA[0-9A-Z]{16}|AROA[0-9A-Z]{16})\b'''
tags = ["key", "AWS"]

[[rules]]
id = "aws-secret"
description = "AWS Secret Key (contextual)"
regex = '''(?i)\b(aws_secret_access_key|secret_access_key)\b\s*[:=]\s*['"]?[0-9a-zA-Z\/+=]{40}['"]?'''
tags = ["key", "AWS"]

[[rules]]
id = "github-pat"
description = "GitHub Personal Access Token"
regex = '''\b(ghp_[0-9A-Za-z]{36}|github_pat_[0-9A-Za-z_]{22,})\b'''
tags = ["key", "GitHub"]

[[rules]]
id = "ssh-private-key"
description = "SSH Private Key"
regex = '''-----BEGIN (OPENSSH PRIVATE KEY|RSA PRIVATE KEY|EC PRIVATE KEY)-----'''
tags = ["key", "SSH"]

[[rules]]
id = "jwt-like"
description = "JWT-like token"
regex = '''\beyJ[a-zA-Z0-9_-]{10,}\.eyJ[a-zA-Z0-9_-]{10,}\.[a-zA-Z0-9_-]{10,}\b'''
tags = ["key", "JWT"]

[[rules]]
id = "ovh-keys"
description = "OVH credentials (contextual keys)"
regex = '''(?i)\b(ovh_)?(application_key|application_secret|consumer_key)\b\s*[:=]\s*['"]?[0-9a-zA-Z]{16,}['"]?'''
tags = ["key", "OVH"]

[[rules]]
id = "db-conn"
description = "Database connection string"
regex = '''\b(postgres|mysql|mongodb):\/\/[^:\s]+:[^@\s]+@[^:\s]+:\d+\/[^\s'"]+'''
tags = ["key", "database"]

[allowlist]
description = "Allow safe docs/test/examples"
paths = [
  "**/*_test.*",
  "**/test/**",
  "**/tests/**",
  "**/docs/**",
  "**/examples/**"
]

stopwords = ["changeme", "example", "dummy", "not_a_real_key"]