title = "Platform Monitoring Secret Rules"
version = "2.2.0"

[[rules]]
id = "aws-access-key-id"
description = "AWS Access Key ID"
regex = '''\b(A3T[A-Z0-9]{16}|AKIA[0-9A-Z]{16}|ASIA[0-9A-Z]{16}|AROA[0-9A-Z]{16})\b'''
tags = ["key", "AWS"]

[[rules]]
id = "aws-secret-access-key"
description = "AWS Secret Access Key (contextual)"
regex = '''(?i)\b(aws_secret_access_key|secret_access_key)\b\s*[:=]\s*['"]?[0-9a-zA-Z\/+=]{40}['"]?'''
tags = ["key", "AWS"]

[[rules]]
id = "github-pat-classic"
description = "GitHub PAT (classic)"
regex = '''\bghp_[0-9A-Za-z]{36}\b'''
tags = ["key", "GitHub"]

[[rules]]
id = "github-pat-finegrained"
description = "GitHub PAT (fine-grained)"
regex = '''\bgithub_pat_[0-9A-Za-z_]{22,}\b'''
tags = ["key", "GitHub"]

[[rules]]
id = "slack-webhook"
description = "Slack Incoming Webhook"
regex = '''https:\/\/hooks\.slack\.com\/services\/[A-Z0-9]{9,}\/[A-Z0-9]{9,}\/[A-Za-z0-9]{20,}'''
tags = ["key", "Slack"]

[[rules]]
id = "private-key-block"
description = "Private key block"
regex = '''-----BEGIN (OPENSSH PRIVATE KEY|RSA PRIVATE KEY|EC PRIVATE KEY)-----'''
tags = ["key", "SSH"]

[[rules]]
id = "jwt-like"
description = "JWT-like token (3 segments)"
regex = '''\beyJ[a-zA-Z0-9_-]{10,}\.eyJ[a-zA-Z0-9_-]{10,}\.[a-zA-Z0-9_-]{10,}\b'''
tags = ["key", "JWT"]

[[rules]]
id = "db-connection-string"
description = "Database connection string (basic)"
regex = '''\b(postgres|mysql|mongodb):\/\/[^:\s]+:[^@\s]+@[^:\s]+:\d+\/[^\s'"]+'''
tags = ["key", "database"]

[allowlist]
description = "Allow known safe fixtures/examples only"
paths = [
  "**/*_test.*",
  "**/test/**",
  "**/tests/**",
  "**/fixtures/**",
  "**/examples/**",
  "**/docs/examples/**"
]

stopwords = [
  "changeme",
  "change_this_password",
  "example",
  "dummy",
  "not_a_real_key",
  "your_secure_password",
  "monitoring.example.com"
]